(this.webpackJsonptest=this.webpackJsonptest||[]).push([[0],{102:function(e,t,i){},103:function(e,t,i){"use strict";i.r(t);var n,a,r,o,s,l,h=i(1),c=i.n(h),u=i(51),f=i(24),y=i(25),d=i(68),g=i(66),p=i(120),v=i(74),m=i(122),x=(i(96),i(72)),k=i(58),b=i(121),w=i(73),S=i(6),C=function(){function e(){Object(f.a)(this,e)}return Object(y.a)(e,[{key:"draw",value:function(e,t,i,n,a,r,o,s){var l,h,c=this._extrude(e,t,n,a,r,o),u=[];if(i)for(l=0,h=i.length;l<h;l++)u[l]=this._extrude(e,i[l],n,a,r,o);if(e.fillStyle=s,e.beginPath(),this._ring(e,c),i)for(l=0,h=u.length;l<h;l++)this._ring(e,u[l]);e.closePath(),e.stroke(),e.fill()}},{key:"_extrude",value:function(e,t,i,n,a,r){for(var o,s,l=le/(le-i),h=le/(le-n),c={x:0,y:0},u={x:0,y:0},f=[],y=0,d=t.length-3;y<d;y+=2)c.x=t[y]-Y,c.y=t[y+1]-$,u.x=t[y+2]-Y,u.y=t[y+3]-$,o=Ie.project(c,l),s=Ie.project(u,l),n&&(c=Ie.project(c,h),u=Ie.project(u,h)),(u.x-c.x)*(o.y-c.y)>(o.x-c.x)*(u.y-c.y)&&(c.x<u.x&&c.y<u.y||c.x>u.x&&c.y>u.y?e.fillStyle=r:e.fillStyle=a,e.beginPath(),this._ring(e,[u.x,u.y,c.x,c.y,o.x,o.y,s.x,s.y]),e.closePath(),e.fill()),f[y]=o.x,f[y+1]=o.y;return f}},{key:"_ring",value:function(e,t){e.moveTo(t[0],t[1]);for(var i=2,n=t.length-1;i<n;i+=2)e.lineTo(t[i],t[i+1])}},{key:"simplified",value:function(e,t,i){if(e.beginPath(),this._ringAbs(e,t),i)for(var n=0,a=i.length;n<a;n++)this._ringAbs(e,i[n]);e.closePath(),e.stroke(),e.fill()}},{key:"_ringAbs",value:function(e,t){e.moveTo(t[0]-Y,t[1]-$);for(var i=2,n=t.length-1;i<n;i+=2)e.lineTo(t[i]-Y,t[i+1]-$)}},{key:"shadow",value:function(e,t,i,n,a){for(var r,o,s=null,l={x:0,y:0},h={x:0,y:0},c=0,u=t.length-3;c<u;c+=2)l.x=t[c]-Y,l.y=t[c+1]-$,h.x=t[c+2]-Y,h.y=t[c+3]-$,r=Oe.project(l,n),o=Oe.project(h,n),a&&(l=Oe.project(l,a),h=Oe.project(h,a)),(h.x-l.x)*(r.y-l.y)>(r.x-l.x)*(h.y-l.y)?(1===s&&e.lineTo(l.x,l.y),s=0,c||e.moveTo(l.x,l.y),e.lineTo(h.x,h.y)):(0===s&&e.lineTo(r.x,r.y),s=1,c||e.moveTo(r.x,r.y),e.lineTo(o.x,o.y));if(i)for(c=0,u=i.length;c<u;c++)this._ringAbs(e,i[c])}},{key:"shadowMask",value:function(e,t,i){if(this._ringAbs(e,t),i)for(var n=0,a=i.length;n<a;n++)this._ringAbs(e,i[n])}},{key:"hitArea",value:function(e,t,i,n,a,r){var o,s,l=null,h={x:0,y:0},c={x:0,y:0},u=le/(le-n),f=le/(le-a);e.fillStyle=r,e.beginPath();for(var y=0,d=t.length-3;y<d;y+=2)h.x=t[y]-Y,h.y=t[y+1]-$,c.x=t[y+2]-Y,c.y=t[y+3]-$,o=Ie.project(h,u),s=Ie.project(c,u),a&&(h=Ie.project(h,f),c=Ie.project(c,f)),(c.x-h.x)*(o.y-h.y)>(o.x-h.x)*(c.y-h.y)?(1===l&&e.lineTo(h.x,h.y),l=0,y||e.moveTo(h.x,h.y),e.lineTo(c.x,c.y)):(0===l&&e.lineTo(o.x,o.y),l=1,y||e.moveTo(o.x,o.y),e.lineTo(s.x,s.y));e.closePath(),e.fill()}}]),e}(),O=function(){function e(){Object(f.a)(this,e),this.data=null}return Object(y.a)(e,[{key:"setData",value:function(e){this.data=e}},{key:"project",value:function(e,t){return{x:(e.x-o)*t+o<<0,y:(e.y-s)*t+s<<0}}},{key:"render",value:function(){var e=this.context;if(e.clearRect(0,0,Z,K),!(n<V||l)){var t,i,a,r,h,c,u,f={x:o+Y,y:s+$},y=this.data.getItems();y.sort((function(e,t){return e.minHeight-t.minHeight||P.getDistance(t.center,f)-P.getDistance(e.center,f)||t.height-e.height}));for(var d=new I,g=new E,p=new C,v=0,m=y.length;v<m;v++)if(t=y[v],!je.isSimple(t)&&(r=t.footprint,T.isVisible(r))){switch(i=t.scale<1?t.height*t.scale:t.height,a=0,t.minHeight&&(a=t.scale<1?t.minHeight*t.scale:t.minHeight),h=t.wallColor||ie,c=t.altColor||ne,u=t.roofColor||ae,e.strokeStyle=c,t.shape){case"cylinder":d.draw(e,t.center,t.radius,t.radius,i,a,h,c,u);break;case"cone":d.draw(e,t.center,t.radius,0,i,a,h,c);break;case"dome":d.draw(e,t.center,t.radius,t.radius/2,i,a,h,c);break;case"sphere":d.draw(e,t.center,t.radius,t.radius,i,a,h,c,u);break;case"pyramid":g.draw(e,r,t.center,i,a,h,c);break;default:p.draw(e,r,t.holes,i,a,h,c,u)}switch(t.roofShape){case"cone":d.draw(e,t.center,t.radius,0,i+t.roofHeight,i,u,""+j.parse(u).lightness(.9));break;case"dome":d.draw(e,t.center,t.radius,t.radius/2,i+t.roofHeight,i,u,""+j.parse(u).lightness(.9));break;case"pyramid":g.draw(e,r,t.center,i+t.roofHeight,i,u,j.parse(u).lightness(.9))}}}}},{key:"setContext",value:function(e){this.context=e}}]),e}(),j=function(){function e(t,i,n,a){Object(f.a)(this,e),this.H=t,this.S=i,this.L=n,this.A=a}return Object(y.a)(e,[{key:"hue2rgb",value:function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}},{key:"clamp",value:function(e,t){return Math.min(t,Math.max(0,e))}},{key:"toRGBA",value:function(){var e=this.clamp(this.H,360),t=this.clamp(this.S,1),i=this.clamp(this.L,1),n={a:this.clamp(this.A,1)};if(0===t)n.r=i,n.g=i,n.b=i;else{var a=i<.5?i*(1+t):i+t-i*t,r=2*i-a;e/=360,n.r=this.hue2rgb(r,a,e+1/3),n.g=this.hue2rgb(r,a,e),n.b=this.hue2rgb(r,a,e-1/3)}return{r:Math.round(255*n.r),g:Math.round(255*n.g),b:Math.round(255*n.b),a:n.a}}},{key:"toString",value:function(){var e=this.toRGBA();return 1===e.a?"#"+((1<<24)+(e.r<<16)+(e.g<<8)+e.b).toString(16).slice(1,7):"rgba("+[e.r,e.g,e.b,e.a.toFixed(2)].join(",")+")"}},{key:"hue",value:function(t){return new e(this.H*t,this.S,this.L,this.A)}},{key:"saturation",value:function(t){return new e(this.H,this.S*t,this.L,this.A)}},{key:"lightness",value:function(t){return new e(this.H,this.S,this.L*t,this.A)}},{key:"alpha",value:function(t){return new e(this.H,this.S,this.L,this.A*t)}}],[{key:"parse",value:function(e){var t,i=0,n=0,a=0,r=1;if(t=(e={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",grey:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"}[e=(""+e).toLowerCase()]||e).match(/^#(\w{2})(\w{2})(\w{2})$/))i=parseInt(t[1],16),n=parseInt(t[2],16),a=parseInt(t[3],16);else{if(!(t=e.match(/rgba?\((\d+)\D+(\d+)\D+(\d+)(\D+([\d.]+))?\)/)))return;i=parseInt(t[1],10),n=parseInt(t[2],10),a=parseInt(t[3],10),r=t[4]?parseFloat(t[5]):1}return this.fromRGBA(i,n,a,r)}},{key:"fromRGBA",value:function(t,i,n,a){"object"===typeof t?(i=t.g/255,n=t.b/255,a=t.a,t=t.r/255):(t/=255,i/=255,n/=255);var r,o,s=Math.max(t,i,n),l=Math.min(t,i,n),h=(s+l)/2,c=s-l;if(c){switch(o=h>.5?c/(2-s-l):c/(s+l),s){case t:r=(i-n)/c+(i<n?6:0);break;case i:r=(n-t)/c+2;break;case n:r=(t-i)/c+4}r*=60}else r=o=0;return new e(r,o,h,a)}}]),e}(),I=function(){function e(){Object(f.a)(this,e)}return Object(y.a)(e,[{key:"draw",value:function(e,t,i,n,a,r,o,s,l){var h,c,u={x:t.x-Y,y:t.y-$},f=le/(le-a),y=le/(le-r),d=Ie.project(u,f);n*=f,r&&(u=Ie.project(u,y),i*=y);var g=this._tangents(u,i,d,n);g?(h=pe(g[0].y1-u.y,g[0].x1-u.x),c=pe(g[1].y1-u.y,g[1].x1-u.x)):(h=1.5*B,c=1.5*B),e.fillStyle=o,e.beginPath(),e.arc(d.x,d.y,n,G,h,!0),e.arc(u.x,u.y,i,h,G),e.closePath(),e.fill(),e.fillStyle=s,e.beginPath(),e.arc(d.x,d.y,n,c,G,!0),e.arc(u.x,u.y,i,G,c),e.closePath(),e.fill(),e.fillStyle=l,this._circle(e,d,n)}},{key:"simplified",value:function(e,t,i){this._circle(e,{x:t.x-Y,y:t.y-$},i)}},{key:"shadow",value:function(e,t,i,n,a,r){var o,s,l={x:t.x-Y,y:t.y-$},h=Oe.project(l,a);r&&(l=Oe.project(l,r));var c=this._tangents(l,i,h,n);c?(o=pe(c[0].y1-l.y,c[0].x1-l.x),s=pe(c[1].y1-l.y,c[1].x1-l.x),e.moveTo(c[1].x2,c[1].y2),e.arc(h.x,h.y,n,s,o),e.arc(l.x,l.y,i,o,s)):(e.moveTo(l.x+i,l.y),e.arc(l.x,l.y,i,0,2*B))}},{key:"shadowMask",value:function(e,t,i){var n={x:t.x-Y,y:t.y-$};e.moveTo(n.x+i,n.y),e.arc(n.x,n.y,i,0,2*B)}},{key:"hitArea",value:function(e,t,i,n,a,r,o){var s,l,h={x:t.x-Y,y:t.y-$},c=le/(le-a),u=le/(le-r),f=Ie.project(h,c);n*=c,r&&(h=Ie.project(h,u),i*=u);var y=this._tangents(h,i,f,n);e.fillStyle=o,e.beginPath(),y?(s=pe(y[0].y1-h.y,y[0].x1-h.x),l=pe(y[1].y1-h.y,y[1].x1-h.x),e.moveTo(y[1].x2,y[1].y2),e.arc(f.x,f.y,n,l,s),e.arc(h.x,h.y,i,s,l)):(e.moveTo(h.x+i,h.y),e.arc(h.x,h.y,i,0,2*B)),e.closePath(),e.fill()}},{key:"_circle",value:function(e,t,i){e.beginPath(),e.arc(t.x,t.y,i,0,2*B),e.stroke(),e.fill()}},{key:"_tangents",value:function(e,t,i,n){var a=e.x-i.x,r=e.y-i.y,o=t-n,s=a*a+r*r;if(!(s<=o*o)){var l,h,c,u=xe(s),f=-a/u,y=-r/u,d=o/u,g=[];l=xe(me(0,1-d*d));for(var p=1;p>=-1;p-=2)h=f*d-p*l*y,c=y*d+p*l*f,g.push({x1:e.x+t*h<<0,y1:e.y+t*c<<0,x2:i.x+n*h<<0,y2:i.y+n*c<<0});return g}}}]),e}(),_=function(){function e(){Object(f.a)(this,e),this.geoJSON=new M,Oe.setData(this),je.setData(this),Ie.setData(this),_e.setData(this),this.DATA_SRC="https://{s}.data.osmbuildings.org/0.2/{k}/tile/{z}/{x}/{y}.json",this.animTimer=null,this.loadedItems={},this.items=[],this.request=new A}return Object(y.a)(e,[{key:"getPixelFootprint",value:function(e){for(var t,i=new Int32Array(e.length),n=0,a=e.length-1;n<a;n+=2)t=T.geoToPixel(e[n],e[n+1]),i[n]=t.x,i[n+1]=t.y;if(!((i=P.simplifyPolygon(i)).length<8))return i}},{key:"getItems",value:function(){return this.items}},{key:"resetItems",value:function(){this.items=[],this.loadedItems={},_e.reset()}},{key:"fadeIn",value:function(){if(!this.animTimer){var e=this;this.animTimer=setInterval((function(){for(var t=e.items,i=!1,n=0,a=t.length;n<a;n++)t[n].scale<1&&(t[n].scale+=.1,t[n].scale>1&&(t[n].scale=1),i=!0);Ce((function(){Oe.render(),je.render(),_e.render(),Ie.render()})),i||(clearInterval(this.animTimer),this.animTimer=null)}),33)}}},{key:"addRenderItems",value:function(e,t){for(var i,n,a,r=this.geoJSON.read(e),o=0,s=r.length;o<s;o++)a=(i=r[o]).id||[i.footprint[0],i.footprint[1],i.height,i.minHeight].join(","),this.loadedItems[a]||(n=this.scale(i))&&(n.scale=t?0:1,this.items.push(n),this.loadedItems[a]=1);this.fadeIn()}},{key:"scale",value:function(e){var t={},i=6/be(2,n-V);if(e.id&&(t.id=e.id),t.height=ve(e.height/i,r),t.realHeight=e.height,t.minHeight=isNaN(e.minHeight)?0:e.minHeight/i,!(t.minHeight>r)&&(t.footprint=this.getPixelFootprint(e.footprint),t.footprint)){if(t.center=P.getCenter(t.footprint),e.radius&&(t.radius=e.radius*re),e.shape&&(t.shape=e.shape),e.roofShape&&(t.roofShape=e.roofShape),"cone"!==t.roofShape&&"dome"!==t.roofShape||t.shape||!P.isRotational(t.footprint)||(t.shape="cylinder"),e.holes){var a;t.holes=[];for(var o=0,s=e.holes.length;o<s;o++)(a=this.getPixelFootprint(e.holes[o]))&&t.holes.push(a)}var l;if(e.wallColor&&(l=j.parse(e.wallColor))&&(l=l.alpha(oe),t.altColor=""+l.lightness(.8),t.wallColor=""+l),e.roofColor&&(l=j.parse(e.roofColor))&&(t.roofColor=""+l.alpha(oe)),e.relationId&&(t.relationId=e.relationId),t.hitColor=_e.idToColor(e.relationId||e.id),t.roofHeight=isNaN(e.roofHeight)?0:e.roofHeight/i,!(t.height+t.roofHeight<=t.minHeight))return t}}},{key:"set",value:function(e){try{JSON.parse(e)}catch(t){return}this.isStatic=!0,this.resetItems(),this._staticData=e,this.addRenderItems(this._staticData,!0)}},{key:"load",value:function(e,t){this.src=e||this.DATA_SRC.replace("{k}",t||"anonymous"),this.update()}},{key:"update",value:function(){if(this.resetItems(),!(n<V))if(this.isStatic&&this._staticData)this.addRenderItems(this._staticData);else if(this.src){var e,t,i=V,a=n>i?256<<n-i:256>>i-n,r=Y/a<<0,o=$/a<<0,s=ke((Y+Z)/a),l=ke(($+K)/a),h=this;for(t=o;t<=l;t++)for(e=r;e<=s;e++)this.loadTile(e,t,i,c)}function c(e){h.addRenderItems(e)}}},{key:"loadTile",value:function(e,t,i,n){var a="abcd"[(e+t)%4],r=this.src.replace("{s}",a).replace("{x}",e).replace("{y}",t).replace("{z}",i);return this.request.loadJSON(r,n)}}]),e}(),T=function(){function e(){Object(f.a)(this,e)}return Object(y.a)(e,null,[{key:"rad",value:function(e){return e*B/180}},{key:"deg",value:function(e){return e/B*180}},{key:"pixelToGeo",value:function(t,i){var n={};return t/=a,i/=a,n[q]=i<=0?90:i>=1?-90:e.deg(2*ge(ce(B*(1-2*i)))-G),n[F]=360*(1===t?1:(t%1+1)%1)-180,n}},{key:"geoToPixel",value:function(e,t){var i=ve(1,me(0,.5-ue(de(W+G*e/180))/B/2));return{x:(t/360+.5)*a<<0,y:i*a<<0}}},{key:"fromRange",value:function(e,t,i,n,a){return e=ve(me(e,t),i),ve(me(n+(e-t)/(i-t)*(a-n),n),a)}},{key:"isVisible",value:function(e){for(var t=Z+Y,i=K+$,n=0,a=e.length-3;n<a;n+=2)if(e[n]>Y&&e[n]<t&&e[n+1]>$&&e[n+1]<i)return!0;return!1}}]),e}(),M=function(){function e(){Object(f.a)(this,e),this.METERS_PER_LEVEL=3,this.materialColors={brick:"#cc7755",bronze:"#ffeecc",canvas:"#fff8f0",concrete:"#999999",copper:"#a0e0d0",glass:"#e8f8f8",gold:"#ffcc00",plants:"#009933",metal:"#aaaaaa",panel:"#fff8f0",plaster:"#999999",roof_tiles:"#f08060",silver:"#cccccc",slate:"#666666",stone:"#996666",tar_paper:"#333333",wood:"#deb887"},this.baseMaterials={asphalt:"tar_paper",bitumen:"tar_paper",block:"stone",bricks:"brick",glas:"glass",glassfront:"glass",grass:"plants",masonry:"stone",granite:"stone",panels:"panel",paving_stones:"stone",plastered:"plaster",rooftiles:"roof_tiles",roofingfelt:"tar_paper",sandstone:"stone",sheet:"canvas",sheets:"canvas",shingle:"tar_paper",shingles:"tar_paper",slates:"slate",steel:"metal",tar:"tar_paper",tent:"canvas",thatch:"plants",tile:"roof_tiles",tiles:"roof_tiles"},this.WINDING_CLOCKWISE="CW",this.WINDING_COUNTER_CLOCKWISE="CCW"}return Object(y.a)(e,[{key:"getMaterialColor",value:function(e){return"#"===(e=e.toLowerCase())[0]?e:this.materialColors[this.baseMaterials[e]||e]||null}},{key:"getWinding",value:function(e){var t,i,n,a,r,o=0;for(a=0,r=e.length-3;a<r;a+=2)t=e[a],i=e[a+1],n=e[a+2],o+=t*e[a+3]-n*i;return o/2>0?this.WINDING_CLOCKWISE:this.WINDING_COUNTER_CLOCKWISE}},{key:"makeWinding",value:function(e,t){if(this.getWinding(e)===t)return e;for(var i=[],n=e.length-2;n>=0;n-=2)i.push(e[n],e[n+1]);return i}},{key:"alignProperties",value:function(e){var t={};e=e||{},t.height=e.height||(e.levels?e.levels*this.METERS_PER_LEVEL:se),t.minHeight=e.minHeight||(e.minLevel?e.minLevel*this.METERS_PER_LEVEL:0);var i=e.material?this.getMaterialColor(e.material):e.wallColor||e.color;i&&(t.wallColor=i);var n=e.roofMaterial?this.getMaterialColor(e.roofMaterial):e.roofColor;switch(n&&(t.roofColor=n),e.shape){case"cylinder":case"cone":case"dome":case"sphere":t.shape=e.shape,t.isRotational=!0;break;case"pyramid":t.shape=e.shape}switch(e.roofShape){case"cone":case"dome":t.roofShape=e.roofShape,t.isRotational=!0;break;case"pyramid":t.roofShape=e.roofShape}return t.roofShape&&e.roofHeight?(t.roofHeight=e.roofHeight,t.height=me(0,t.height-t.roofHeight)):t.roofHeight=0,t}},{key:"getGeometries",value:function(e){var t,i,n,a,r=[];switch(e.type){case"GeometryCollection":for(r=[],t=0,i=e.geometries.length;t<i;t++)(a=this.getGeometries(e.geometries[t]))&&r.push.apply(r,a);return r;case"MultiPolygon":for(r=[],t=0,i=e.coordinates.length;t<i;t++)(a=this.getGeometries({type:"Polygon",coordinates:e.coordinates[t]}))&&r.push.apply(r,a);return r;case"Polygon":n=e.coordinates;break;default:return[]}var o,s,l,h=[],c=[];for(t=0,i=(l=n[0]).length;t<i;t++)h.push(l[t][1],l[t][0]);for(h=this.makeWinding(h,this.WINDING_CLOCKWISE),t=0,i=n.length-1;t<i;t++){for(l=n[t+1],c[t]=[],o=0,s=l.length;o<s;o++)c[t].push(l[o][1],l[o][0]);c[t]=this.makeWinding(c[t],this.WINDING_COUNTER_CLOCKWISE)}return[{outer:h,inner:c.length?c:null}]}},{key:"clone",value:function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}},{key:"read",value:function(e){if(!e||"FeatureCollection"!==e.type)return[];var t,i,n,a,r,o,s,l,h=e.features,c=[];for(t=0,i=h.length;t<i;t++)if("Feature"===(r=h[t]).type)for(s=this.alignProperties(r.properties),n=0,a=(o=this.getGeometries(r.geometry)).length;n<a;n++)(l=this.clone(s)).footprint=o[n].outer,l.isRotational&&(l.radius=P.getLonDelta(l.footprint)),o[n].inner&&(l.holes=o[n].inner),(r.id||r.properties.id)&&(l.id=r.id||r.properties.id),r.properties.relationId&&(l.relationId=r.properties.relationId),c.push(l);return c}}]),e}(),P=function(){function e(){Object(f.a)(this,e)}return Object(y.a)(e,null,[{key:"getDistance",value:function(e,t){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}},{key:"isRotational",value:function(t){var i,n=t.length;if(n<16)return!1;var a=1/0,r=-1/0,o=1/0,s=-1/0;for(i=0;i<n-1;i+=2)a=Math.min(a,t[i]),r=Math.max(r,t[i]),o=Math.min(o,t[i+1]),s=Math.max(s,t[i+1]);var l=r-a,h=s-o,c=l/h;if(c<.85||c>1.15)return!1;var u={x:a+l/2,y:o+h/2},f=(l+h)/4,y=f*f;for(i=0;i<n-1;i+=2){var d=e.getDistance({x:t[i],y:t[i+1]},u);if(d/y<.8||d/y>1.2)return!1}return!0}},{key:"getSquareSegmentDistance",value:function(e,t,i,n,a,r){var o,s=a-i,l=r-n;return 0===s&&0===l||((o=((e-i)*s+(t-n)*l)/(s*s+l*l))>1?(i=a,n=r):o>0&&(i+=s*o,n+=l*o)),(s=e-i)*s+(l=t-n)*l}},{key:"simplifyPolygon",value:function(t){var i,n,a,r,o=t.length/2,s=new Uint8Array(o),l=0,h=o-1,c=[],u=[],f=[];for(s[l]=s[h]=1;h;){for(n=0,i=l+1;i<h;i++)(a=e.getSquareSegmentDistance(t[2*i],t[2*i+1],t[2*l],t[2*l+1],t[2*h],t[2*h+1]))>n&&(r=i,n=a);n>2&&(s[r]=1,c.push(l),u.push(r),c.push(r),u.push(h)),l=c.pop(),h=u.pop()}for(i=0;i<o;i++)s[i]&&f.push(t[2*i],t[2*i+1]);return f}},{key:"getCenter",value:function(e){for(var t=1/0,i=-1/0,n=1/0,a=-1/0,r=0,o=e.length-3;r<o;r+=2)t=ve(t,e[r]),i=me(i,e[r]),n=ve(n,e[r+1]),a=me(a,e[r+1]);return{x:t+(i-t)/2<<0,y:n+(a-n)/2<<0}}},{key:"getLonDelta",value:function(e){for(var t=180,i=-180,n=0,a=e.length;n<a;n+=2)t=ve(t,e[n+1]),i=me(i,e[n+1]);return(i-t)/2}}]),e}(),H=function(){function e(){Object(f.a)(this,e),this.data=null,this._idMapping=[null]}return Object(y.a)(e,[{key:"setData",value:function(e){this.data=e}},{key:"reset",value:function(){this._idMapping=[null]}},{key:"render",value:function(){if(!this._timer){var e=this;this._timer=setTimeout((function(){e._timer=null,e._render()}),500)}}},{key:"_render",value:function(){var e=this.context;if(e.clearRect(0,0,Z,K),!(n<V||l)){var t,i,a,r,h,c={x:o+Y,y:s+$},u=this.data.getItems();u.sort((function(e,t){return e.minHeight-t.minHeight||P.getDistance(t.center,c)-P.getDistance(e.center,c)||t.height-e.height}));for(var f=new I,y=new E,d=new C,g=0,p=u.length;g<p;g++)if((h=(t=u[g]).hitColor)&&(r=t.footprint,T.isVisible(r))){switch(i=t.height,a=0,t.minHeight&&(a=t.minHeight),t.shape){case"cylinder":f.hitArea(e,t.center,t.radius,t.radius,i,a,h);break;case"cone":f.hitArea(e,t.center,t.radius,0,i,a,h);break;case"dome":f.hitArea(e,t.center,t.radius,t.radius/2,i,a,h);break;case"sphere":f.hitArea(e,t.center,t.radius,t.radius,i,a,h);break;case"pyramid":y.hitArea(e,r,t.center,i,a,h);break;default:d.hitArea(e,r,t.holes,i,a,h)}switch(t.roofShape){case"cone":f.hitArea(e,t.center,t.radius,0,i+t.roofHeight,i,h);break;case"dome":f.hitArea(e,t.center,t.radius,t.radius/2,i+t.roofHeight,i,h);break;case"pyramid":y.hitArea(e,r,t.center,i+t.roofHeight,i,h)}}Z&&K&&(this._imageData=this.context.getImageData(0,0,Z,K).data)}}},{key:"getIdFromXY",value:function(e,t){var i=this._imageData;if(i){var n=4*((0|t)*Z+(0|e)),a=i[n]|i[n+1]<<8|i[n+2]<<16;return this._idMapping[a]}}},{key:"idToColor",value:function(e){var t=this._idMapping.indexOf(e);return-1===t&&(this._idMapping.push(e),t=this._idMapping.length-1),"rgb("+[255&t,t>>8&255,t>>16&255].join(",")+")"}},{key:"setContext",value:function(e){this.context=e}}]),e}(),D=function(){function e(){Object(f.a)(this,e),this.container=document.createElement("DIV"),this.items=[],this.container.style.pointerEvents="none",this.container.style.position="absolute",this.container.style.left=0,this.container.style.top=0,Oe.setContext(this.createContext(this.container)),je.setContext(this.createContext(this.container)),Ie.setContext(this.createContext(this.container)),_e.setContext(this.createContext())}return Object(y.a)(e,[{key:"render",value:function(e){Ce((function(){e||(Oe.render(),je.render(),_e.render()),Ie.render()}))}},{key:"createContext",value:function(e){var t=document.createElement("CANVAS");t.style.transform="translate3d(0, 0, 0)",t.style.imageRendering="optimizeSpeed",t.style.position="absolute",t.style.left=0,t.style.top=0;var i=t.getContext("2d");return i.lineCap="round",i.lineJoin="round",i.lineWidth=1,i.imageSmoothingEnabled=!1,this.items.push(t),e&&e.appendChild(t),i}},{key:"appendTo",value:function(e){e.appendChild(this.container)}},{key:"remove",value:function(){this.container.parentNode.removeChild(this.container)}},{key:"setSize",value:function(e,t){for(var i=0,n=this.items.length;i<n;i++)this.items[i].width=e,this.items[i].height=t}},{key:"setPosition",value:function(e,t){this.container.style.left=e+"px",this.container.style.top=t+"px"}}]),e}(),E=function(){function e(){Object(f.a)(this,e)}return Object(y.a)(e,[{key:"draw",value:function(e,t,i,n,a,r,o){for(var s={x:i.x-Y,y:i.y-$},l=le/(le-n),h=le/(le-a),c=Ie.project(s,l),u={x:0,y:0},f={x:0,y:0},y=0,d=t.length-3;y<d;y+=2)u.x=t[y]-Y,u.y=t[y+1]-$,f.x=t[y+2]-Y,f.y=t[y+3]-$,a&&(u=Ie.project(u,h),f=Ie.project(f,h)),(f.x-u.x)*(c.y-u.y)>(c.x-u.x)*(f.y-u.y)&&(u.x<f.x&&u.y<f.y||u.x>f.x&&u.y>f.y?e.fillStyle=o:e.fillStyle=r,e.beginPath(),this._triangle(e,u,f,c),e.closePath(),e.fill())}},{key:"_triangle",value:function(e,t,i,n){e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.lineTo(n.x,n.y)}},{key:"_ring",value:function(e,t){e.moveTo(t[0]-Y,t[1]-$);for(var i=2,n=t.length-1;i<n;i+=2)e.lineTo(t[i]-Y,t[i+1]-$)}},{key:"shadow",value:function(e,t,i,n,a){for(var r={x:0,y:0},o={x:0,y:0},s={x:i.x-Y,y:i.y-$},l=Oe.project(s,n),h=0,c=t.length-3;h<c;h+=2)r.x=t[h]-Y,r.y=t[h+1]-$,o.x=t[h+2]-Y,o.y=t[h+3]-$,a&&(r=Oe.project(r,a),o=Oe.project(o,a)),(o.x-r.x)*(l.y-r.y)>(l.x-r.x)*(o.y-r.y)&&this._triangle(e,r,o,l)}},{key:"shadowMask",value:function(e,t){this._ring(e,t)}},{key:"hitArea",value:function(e,t,i,n,a,r){var o={x:i.x-Y,y:i.y-$},s=le/(le-n),l=le/(le-a),h=Ie.project(o,s),c={x:0,y:0},u={x:0,y:0};e.fillStyle=r,e.beginPath();for(var f=0,y=t.length-3;f<y;f+=2)c.x=t[f]-Y,c.y=t[f+1]-$,u.x=t[f+2]-Y,u.y=t[f+3]-$,a&&(c=Ie.project(c,l),u=Ie.project(u,l)),(u.x-c.x)*(h.y-c.y)>(h.x-c.x)*(u.y-c.y)&&this._triangle(e,c,u,h);e.closePath(),e.fill()}}]),e}(),A=function(){function e(){Object(f.a)(this,e),this.cacheData={},this.cacheIndex=[],this.cacheSize=0,this.maxCacheSize=5242880}return Object(y.a)(e,[{key:"xhr",value:function(e,t){if(!this.cacheData[e]){var i=new XMLHttpRequest,n=this;return i.onreadystatechange=function(){if(4===i.readyState&&!(!i.status||i.status<200||i.status>299)&&t&&i.responseText){var a=i.responseText;for(n.cacheData[e]=a,n.cacheIndex.push({url:e,size:a.length}),n.cacheSize+=a.length,t(a);n.cacheSize>n.maxCacheSize;){var r=n.cacheIndex.shift();n.cacheSize-=r.size,delete n.cacheData[r.url]}}},i.open("GET",e),i.send(null),i}t&&t(this.cacheData[e])}},{key:"loadJSON",value:function(e,t){return this.xhr(e,(function(e){var i;try{i=JSON.parse(e)}catch(n){}t(i)}))}}]),e}(),R=function(){function e(){Object(f.a)(this,e),this.sunPosition=new N,this.enabled=!0,this.color="#666666",this.blurColor="#000000",this.blurSize=15,this.date=new Date,this.direction={x:0,y:0},this.context=null,this.data=null}return Object(y.a)(e,[{key:"project",value:function(e,t){return{x:e.x+this.direction.x*t,y:e.y+this.direction.y*t}}},{key:"setData",value:function(e){this.data=e}},{key:"render",value:function(){var e,t,i,a,r=this.context;if(r.clearRect(0,0,Z,K),!(!this.enabled||n<V||l)&&(e=T.pixelToGeo(U+Y,X+$),!((t=this.sunPosition.getSunPosition(this.date,e.latitude,e.longitude)).altitude<=0))){a=(i=1/de(t.altitude))<5?.75:1/i*5,this.direction.x=ye(t.azimuth)*i,this.direction.y=fe(t.azimuth)*i;var o,s,h,c,u,f,y=this.data.getItems();r.canvas.style.opacity=a/(2*oe),r.shadowColor=this.blurColor,r.shadowBlur=this.blurSize*(oe/2),r.fillStyle=this.color,r.beginPath();var d=new I,g=new E,p=new C;for(o=0,s=y.length;o<s;o++)if(f=(h=y[o]).footprint,T.isVisible(f)){switch(c=h.scale<1?h.height*h.scale:h.height,u=0,h.minHeight&&(u=h.scale<1?h.minHeight*h.scale:h.minHeight),h.shape){case"cylinder":d.shadow(r,h.center,h.radius,h.radius,c,u);break;case"cone":d.shadow(r,h.center,h.radius,0,c,u);break;case"dome":d.shadow(r,h.center,h.radius,h.radius/2,c,u);break;case"sphere":d.shadow(r,h.center,h.radius,h.radius,c,u);break;case"pyramid":g.shadow(r,f,h.center,c,u);break;default:p.shadow(r,f,h.holes,c,u)}switch(h.roofShape){case"cone":d.shadow(r,h.center,h.radius,0,c+h.roofHeight,c);break;case"dome":d.shadow(r,h.center,h.radius,h.radius/2,c+h.roofHeight,c);break;case"pyramid":g.shadow(r,f,h.center,c+h.roofHeight,c)}}for(r.closePath(),r.fill(),r.shadowBlur=null,r.globalCompositeOperation="destination-out",r.beginPath(),o=0,s=y.length;o<s;o++)if(f=(h=y[o]).footprint,T.isVisible(f)&&!h.minHeight)switch(h.shape){case"cylinder":case"cone":case"dome":d.shadowMask(r,h.center,h.radius);break;default:p.shadowMask(r,f,h.holes)}r.fillStyle="#00ff00",r.fill(),r.globalCompositeOperation="source-over"}}},{key:"setContext",value:function(e){this.context=e}}]),e}(),L=function(){function e(){Object(f.a)(this,e),this.data=null,this.init()}return Object(y.a)(e,[{key:"setData",value:function(e){this.data=e}},{key:"init",value:function(){this.maxZoom=this.MIN_ZOOM+2,this.maxHeight=5}},{key:"isSimple",value:function(e){return n<=this.maxZoom&&e.height+e.roofHeight<this.maxHeight}},{key:"render",value:function(){var e=this.context;if(e.clearRect(0,0,Z,K),!(n<V||l||n>this.maxZoom))for(var t,i,a=this.data.getItems(),r=new I,o=new C,s=0,h=a.length;s<h;s++)if(!((t=a[s]).height>=this.maxHeight)&&(i=t.footprint,T.isVisible(i)))switch(e.strokeStyle=t.altColor||ne,e.fillStyle=t.roofColor||ae,t.shape){case"cylinder":case"cone":case"dome":case"sphere":r.simplified(e,t.center,t.radius);break;default:o.simplified(e,i,t.holes)}}},{key:"setContext",value:function(e){this.context=e}}]),e}(),N=function(){function e(){Object(f.a)(this,e),this.init()}return Object(y.a)(e,[{key:"init",value:function(){this.m=Math,this.PI=he.PI,this.sin=he.sin,this.cos=he.cos,this.tan=he.tan,this.asin=he.asin,this.atan=he.atan2,this.rad=B/180,this.dayMs=864e5,this.J1970=2440588,this.J2000=2451545,this.e=23.4397*this.rad}},{key:"toJulian",value:function(e){return e.valueOf()/this.dayMs-.5+this.J1970}},{key:"toDays",value:function(e){return this.toJulian(e)-this.J2000}},{key:"getRightAscension",value:function(e,t){return this.atan(this.sin(e)*this.cos(this.e)-this.tan(t)*this.sin(this.e),this.cos(e))}},{key:"getDeclination",value:function(e,t){return this.asin(this.sin(t)*this.cos(this.e)+this.cos(t)*this.sin(this.e)*this.sin(e))}},{key:"getAzimuth",value:function(e,t,i){return this.atan(this.sin(e),this.cos(e)*this.sin(t)-this.tan(i)*this.cos(t))}},{key:"getAltitude",value:function(e,t,i){return this.asin(this.sin(t)*this.sin(i)+this.cos(t)*this.cos(i)*this.cos(e))}},{key:"getSiderealTime",value:function(e,t){return this.rad*(280.16+360.9856235*e)-t}},{key:"getSolarMeanAnomaly",value:function(e){return this.rad*(357.5291+.98560028*e)}},{key:"getEquationOfCenter",value:function(e){return this.rad*(1.9148*this.sin(e)+.02*this.sin(2*e)+3e-4*this.sin(3*e))}},{key:"getEclipticLongitude",value:function(e,t){return e+t+102.9372*this.rad+this.PI}},{key:"getSunPosition",value:function(e,t,i){var n=this.rad*-i,a=this.rad*t,r=this.toDays(e),o=this.getSolarMeanAnomaly(r),s=this.getEquationOfCenter(o),l=this.getEclipticLongitude(o,s),h=this.getDeclination(l,0),c=this.getRightAscension(l,0),u=this.getSiderealTime(r,n)-c;return{altitude:this.getAltitude(u,a,h),azimuth:this.getAzimuth(u,a,h)-this.PI/2}}}]),e}(),z=function(e){Object(d.a)(i,e);var t=Object(g.a)(i);function i(e){var n;Object(f.a)(this,i),(n=t.call(this)).style=function(e){var t;return(t=(e=e||{}).color||e.wallColor)&&(Q=j.parse(t),ie=""+Q.alpha(oe),ee=Q.lightness(.8),ne=""+ee.alpha(oe),te=Q.lightness(1.2),ae=""+te.alpha(oe)),e.roofColor&&(te=j.parse(e.roofColor),ae=""+te.alpha(oe)),void 0!==e.shadows&&(Oe.enabled=!!e.shadows),Me.render(),this},n.date=function(e){return Oe.date=e,Oe.render(),this},n.load=function(e){return Te.load(e),this},n.unload=function(){return this.map.removeLayer(this),Me.remove(),Te.resetItems(),Te=new _,this},n.onEach=function(){},n.each=function(e){return this.onEach=function(t){return e(t)},this},n.onClick=function(){},n.click=function(e){return this.onClick=function(t){return e(t)},this},n.source=new w.a({projection:S.f("EPSG:900913")}),n.map=e,n.maxExtent=[-20037508.34,-20037508.34,20037508.34,20037508.34];try{n.setMap(e),e.addLayer(Object(k.a)(n))}catch(a){console.log(a)}return n.VERSION="0.2.2b",n.ATTRIBUTION='&copy; <a href="http://osmbuildings.org">OSM Buildings</a>',n}return Object(y.a)(i,[{key:"source",value:function(){return this.getSource()}},{key:"removeLayer",value:function(){this.map.removeLayer(this),Me.remove()}},{key:"setGlobalOrigin",value:function(e){Y=e.x,$=e.y}},{key:"moveCam",value:function(e){o=U+e.x,s=K+e.y,Me.render(!0)}},{key:"setSize",value:function(e){Z=e.width,K=e.height,X=K/2<<0,o=U=Z/2<<0,s=K,Me.setSize(Z,K),r=le-50}},{key:"setZoom",value:function(e){a=J<<(n=e);var t=T.pixelToGeo(Y+U,$+X),i=T.geoToPixel(t.latitude,0),r=T.geoToPixel(t.latitude,1);re=r.x-i.x,oe=be(.95,n-V),ie=""+Q.alpha(oe),ne=""+ee.alpha(oe),ae=""+te.alpha(oe)}},{key:"onResize",value:function(e){this.setSize(e),Me.render(),Te.update()}},{key:"onMoveEnd",value:function(e){Me.render(),Te.update()}},{key:"onZoomStart",value:function(){l=!0,Me.render()}},{key:"onZoomEnd",value:function(e){l=!1,this.setZoom(e.zoom),Te.update(),Me.render()}},{key:"setOrigin",value:function(){var e=this.map;try{var t=e.getCoordinateFromPixel([0,0]),i=e.getView().getResolution(),n=this.maxExtent,a=(t[0]-n[0])/i<<0,r=(n[3]-t[1])/i<<0;this.setGlobalOrigin({x:a,y:r})}catch(o){console.log(o)}}},{key:"setMap",value:function(e){var t=this;Me.appendTo(document.getElementById(e.getTargetElement().id)),this.setSize({width:e.getSize()[0],height:e.getSize()[1]}),e.on("precompose",(function(i){t.setZoom(e.getView().getZoom()),t.setOrigin(),Te.resetItems(),Te.update()}))}},{key:"set",value:function(e){return Te.set(e),this}},{key:"getDataItems",value:function(){return Te.getItems()}}]),i}(b.a),B=Math.PI,G=B/2,W=B/4,J=256,V=15,q="latitude",F="longitude",Z=0,K=0,U=0,X=0,Y=0,$=0,Q=j.parse("rgba(200, 190, 180)"),ee=Q.lightness(.8),te=Q.lightness(1.2),ie=""+Q,ne=""+ee,ae=""+te,re=0,oe=1,se=5,le=450,he=Math,ce=he.exp,ue=he.log,fe=he.sin,ye=he.cos,de=he.tan,ge=he.atan,pe=he.atan2,ve=he.min,me=he.max,xe=he.sqrt,ke=he.ceil,be=he.pow,we=/iP(ad|hone|od)/g.test(navigator.userAgent),Se=!!~navigator.userAgent.indexOf("Trident"),Ce=!window.requestAnimationFrame||we||Se?function(e){e()}:window.requestAnimationFrame,Oe=new R,je=new L,Ie=new O,_e=new H,Te=new _,Me=new D,Pe=i(119),He=function(e){Object(d.a)(i,e);var t=Object(g.a)(i);function i(e){var n;return Object(f.a)(this,i),(n=t.call(this,e)).componentDidMount=function(){var e=new p.a({target:"mapContainer",layers:[new m.a({source:new x.a})],view:new v.a({center:S.m([13.33522,52.5044],"EPSG:4326","EPSG:3857"),zoom:16})});n.setState({map:e})},n.toggleOSMBuildings=function(){n.state.OSMBuildings?(n.osmBuildings.unload(),n.setState({text:"Show Buildings"})):(n.osmBuildings=new z(n.state.map),n.osmBuildings.date(new Date(2017,5,15,17,30)),n.osmBuildings.load(),n.setState({text:"Hide Buildings"}))},n.state={map:null,featuresLayer:null,OSMBuildings:!1,text:"Show Buildings"},n}return Object(y.a)(i,[{key:"render",value:function(){var e=this,t=this.state.text;return c.a.createElement("div",null,c.a.createElement("div",{id:"mapContainer",style:{width:"100%",height:"500px",backgroundColor:"#ffffff"}}),c.a.createElement(Pe.a,{style:{margin:5},color:this.state.OSMBuildings?"secondary":"primary",variant:"contained",onClick:function(){return e.setState({OSMBuildings:!e.state.OSMBuildings},e.toggleOSMBuildings())}},t))}}]),i}(c.a.Component);i(102);Object(u.render)(c.a.createElement(He,null),document.getElementById("root"))},91:function(e,t,i){e.exports=i(103)}},[[91,1,2]]]);
//# sourceMappingURL=main.dcb9f93e.chunk.js.map